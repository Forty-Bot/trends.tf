{# SPDX-License-Identifier: AGPL-3.0-only #}
{# Copyright (C) 2020 Sean Anderson <seanga2@gmail.com> #}
{% from "macros/wlt.html" import wlt %}
{% extends "base.html" %}
{% block title %}{{ g.player['name'] }} - {{ super() }}{% endblock %}
{% macro stats() %}
<table>
	<thead><tr>
		<td class="left"><abbr title="Wins-Losses-Ties">W-L-T</abbr></td>
		<td class="left"><abbr title="Ties count as 0.5 wins">Winrate</abbr></td>
		<td class="left"><abbr title="Wins-Losses-Ties, witdout ties under 60s">Round W-L-T</abbr></td>
		<td class="left"><abbr title="Ties count as 0.5 wins">Round Winrate</abbr></td>
	</tr></thead>
	<tbody class="hier"><tr>
		<td>{{ wlt(g.player['wins'], g.player['losses'], g.player['ties']) }}</td>
		<td>{{ "{:.2%}".format(g.player['winrate']) }}</td>
		<td>{{ wlt(g.player['round_wins'], g.player['round_losses'],
			g.player['round_ties']) }}</td>
		<td>{{ "{:.2%}".format(g.player['round_winrate']) }}</td>
	</tr></tbody>
</table>
{% endmacro %}
{% block content %}
	{{ super() }}
	<div class="box">
		<div class="avatar">
			<img src="{{ g.player['avatarhash'] | avatar('full') }}">
			<div class="box">
				<h1><a href="https://steamcommunity.com/profiles/{{ g.player['steamid64'] }}">
					{{ g.player['name'] }}
				</a></h1>
				{{ stats() }}
			</div>
		</div>

		<ul class="affiliate">
			<li><a href="https://rgl.gg/Public/PlayerProfile.aspx?p={{ g.player['steamid64'] }}">
				<img title="RGL.gg"
				 src="{{ url_for('static', filename="img/rgl.png") }}">
			</a></li>
			<li><a href="https://www.ugcleague.com/players_page.cfm?player_id={{ g.player['steamid64'] }}">
				<img title="UGC League"
				 src="{{ url_for('static', filename="img/ugc.png") }}">
			</a></li>
			{% if g.etf2lid != None %}
			<li><a href="https://etf2l.org/forum/user/{{ g.etf2lid }}/">
			{% else %}
			<li><a href="https://etf2l.org/search/{{ g.player['steamid64'] }}/">
			{% endif %}
				<img title="European Team Fortress 2 League"
				 src="{{ url_for('static', filename="img/etf2l.png") }}">
			</a></li>
			<li><a href="https://ozfortress.com/users?q={{ g.player['steamid64'] }}">
				<img title="OZFortress"
				 src="{{ url_for('static', filename="img/ozf.png") }}">
			</a></li>
		</ul>

	</div>

	<ul class="nav">
	{% for (endpoint, name) in (('.overview', "Overview"), ('.logs', "Logs"),
	                            ('.peers', "Peers"), ('.totals', "Totals"),
				    ('.weapons', "Weapons"), ('.trends', "Trends"),
				    ('.maps', "Maps")) %}
		{% set url = url_for(endpoint, steamid=g.player['steamid64']) %}
		<li class="nav"><a class="{{ "active" if url == request.path }}" href="{{ url }}">
			{{ name }}
		</a></li>
	{% endfor %}
	</ul>
{% endblock %}
