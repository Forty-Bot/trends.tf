{# SPDX-License-Identifier: AGPL-3.0-only #}
{# Copyright (C) 2021 Sean Anderson <seanga2@gmail.com> #}
{% macro create_sort(order, args) %}
	{% if order['sort'] == args['sort'] and order['sort_dir'] == args['sort_dir'] %}
		{% set elem = 'span' %}
	{% else %}
		{% set elem = 'a' %}
	{% endif %}
	<{{ elem | safe }} class="sort" href="{{ url_for(request.endpoint, **args) }}"
	   title="{{ {'asc': "Sort Ascending", 'desc': "Sort Descending"}[args['sort_dir']] }}">
		{{ {'asc': "\u25B2", 'desc':"\u25BC"}[args['sort_dir']] }}
	</{{ elem | safe }}>
{% endmacro %}
{% macro sort(order, column) %}
	{% set args = request.args.copy() %}
	{% do args.update(request.view_args) %}
	{# Reset our page position #}
	{% do args.pop('limit', None) %}
	{% do args.pop('offset', None) %}
	{% do args.__setitem__('sort', column) %}
	{% do args.__setitem__('sort_dir', 'desc') %}
	{{ create_sort(order, args) }}
	{% do args.__setitem__('sort_dir', 'asc') %}
	{{ create_sort(order, args) }}
{% endmacro %}
